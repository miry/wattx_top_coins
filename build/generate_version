#!/usr/bin/env bash

set -euo pipefail

cd "$(dirname "${BASH_SOURCE[0]}")/.."

# To ignore changes in this file https://stackoverflow.com/questions/10755655/git-ignore-tracked-files
# git update-index --assume-unchanged pkg/version/base.go
# if require changes
# git update-index --no-assume-unchanged pkg/version/base.go

cat > pkg/version/base_generated.go <<EOD
package version

// Code generated by $0. DO NOT EDIT.
func init() {
  gitCommit = "$(git rev-parse HEAD)"
  gitBranch = "$(git rev-parse --abbrev-ref HEAD)"
  gitUser   = "$(git show -s --format='%an'  HEAD)"
  buildHost = "$(hostname)"
  buildDate = "$(date)"
}
EOD
